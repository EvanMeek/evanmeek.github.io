<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2020-11-10 二 15:31 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>&lrm;</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Evan Meek">
<link rel="shortcut icon" href="/images/rose-red.png" type="image/x-icon" />
<link rel="stylesheet" href="/css/animate.min.css" />
<link rel="stylesheet" href="/css/all.min.css" />
<link rel="stylesheet" type="text/css" href="/css/style.css" />
<script src="/js/jquery.min.js"></script>
<script src="/js/darkreader.js"></script>
<script src="/js/main.js"></script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org852a262">WIKI</a>
<ul>
<li><a href="#orgbc32378">ivy-dired下重命名确认 <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-05-15 五&gt;</span></span>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="emacs">emacs</span>&#xa0;<span class="ivy">ivy</span>&#xa0;<span class="dired">dired</span></span></a></li>
<li><a href="#org46bbbce">Linux下调节屏幕亮度 <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-19 六&gt;</span></span>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="linux">linux</span></span></a>
<ul>
<li><a href="#org4dd8ee8">查看亮度是由谁控制的</a></li>
<li><a href="#org71c05b9">查看最大亮度</a></li>
<li><a href="#org4165366">设置当前亮度</a></li>
<li><a href="#org3d2d8f6">可能会遇到的问题</a></li>
</ul>
</li>
<li><a href="#org52473ab">关于endian的那点事 <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-24 四&gt;</span></span>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="os">os</span></span></a>
<ul>
<li><a href="#orgac949f1">故事</a></li>
<li><a href="#org600e8b5">技术</a></li>
</ul>
</li>
<li><a href="#org468eadb">紫薯布丁 <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-10-15 四&gt;</span></span>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="life">life</span></span></a></li>
<li><a href="#orge924fd8">上课时走神看到的陶渊明写的诗句 <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-10-15 四&gt;</span></span>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="life">life</span></span></a></li>
<li><a href="#org478554f">丢弃不稳定的xmodmap，转而使用hwdb设置键盘映射 <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-10-20 二&gt;</span></span>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="linux">linux</span></span></a>
<ul>
<li><a href="#org1ba354b">依赖包</a></li>
<li><a href="#org4c23353">具体操作</a>
<ul>
<li><a href="#orga83311c">获取必要信息</a></li>
<li><a href="#org477c1b2">编写自定义按键映射</a></li>
<li><a href="#orgba0803b">加载配置</a></li>
<li><a href="#orgf1959dd">最后</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org852a262" class="outline-2">
<h2 id="org852a262">WIKI</h2>
<div class="outline-text-2" id="text-org852a262">
<blockquote>
<p>
只要我记录的够多，这里就能成为百科全书。
</p>
</blockquote>
</div>

<div id="outline-container-orgbc32378" class="outline-3">
<h3 id="orgbc32378">ivy-dired下重命名确认 <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-05-15 五&gt;</span></span>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="emacs">emacs</span>&#xa0;<span class="ivy">ivy</span>&#xa0;<span class="dired">dired</span></span></h3>
<div class="outline-text-3" id="text-orgbc32378">
<p>
在我使用 <code>(dired-do-rename)</code> 时发现如果重命名时新名称跟旧名称相似，直接按回车是无法修改的，因为ivy会自动将旧名称补全为新名称，等于没有修改，所以我们在重命名时，输入新名称后，可以调用命令 <code>(ivy-immediate-done)</code> 默认快捷键是<sub>C</sub>-M-j_，这样就可以直接确认，ivy也不会将旧名称补全给新名称。
</p>
</div>
</div>
<div id="outline-container-org46bbbce" class="outline-3">
<h3 id="org46bbbce">Linux下调节屏幕亮度 <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-19 六&gt;</span></span>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="linux">linux</span></span></h3>
<div class="outline-text-3" id="text-org46bbbce">
</div>
<div id="outline-container-org4dd8ee8" class="outline-4">
<h4 id="org4dd8ee8">查看亮度是由谁控制的</h4>
<div class="outline-text-4" id="text-org4dd8ee8">
<div class="org-src-container">
<pre class="src src-shell">ls /sys/class/backlight/
</pre>
</div>
</div>
</div>
<div id="outline-container-org71c05b9" class="outline-4">
<h4 id="org71c05b9">查看最大亮度</h4>
<div class="outline-text-4" id="text-org71c05b9">
<div class="org-src-container">
<pre class="src src-shell">cat /sys/class/backlight/intel_backlight/max_brightness
</pre>
</div>
</div>
</div>
<div id="outline-container-org4165366" class="outline-4">
<h4 id="org4165366">设置当前亮度</h4>
<div class="outline-text-4" id="text-org4165366">
<div class="org-src-container">
<pre class="src src-shell">cat /sys/class/backlight/intel_backlight/max_brightness &gt; /sys/class/backlight/intel_backlight/brightness 
</pre>
</div>
</div>
</div>

<div id="outline-container-org3d2d8f6" class="outline-4">
<h4 id="org3d2d8f6">可能会遇到的问题</h4>
<div class="outline-text-4" id="text-org3d2d8f6">
<p>
设置亮度可能会出现权限问题，那么可以这样设置:
</p>
<div class="org-src-container">
<pre class="src src-shell">sudo chmod 777 /sys/class/backlight/intel_backlight/brightness
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org52473ab" class="outline-3">
<h3 id="org52473ab">关于endian的那点事 <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-09-24 四&gt;</span></span>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="os">os</span></span></h3>
<div class="outline-text-3" id="text-org52473ab">
<blockquote>
<p>
今天看《深入理解操作系统原理》一书了解到endian，它背后有个小故事，我感觉挺有趣的，故抄写下来，有空当笑料。
</p>
</blockquote>
</div>
<div id="outline-container-orgac949f1" class="outline-4">
<h4 id="orgac949f1">故事</h4>
<div class="outline-text-4" id="text-orgac949f1">
<p>
在很久很久以前，有一位国王吃鸡蛋因为打破鸡蛋较大的一端而让手指受伤，这位国王就命令其子民日后吃鸡蛋只能从较小的一端破壳开吃，并将其颁为“法律”。有些子民不满，甚至发起暴乱、逃离他国，从此就有了little endian和big endian的说法。
</p>
</div>
</div>
<div id="outline-container-org600e8b5" class="outline-4">
<h4 id="org600e8b5">技术</h4>
<div class="outline-text-4" id="text-org600e8b5">
<p>
操作系统中有关于字节顺序排列的一个问题，就是字节顺序排列是从大到小还是从小到大，操作系统真有趣，哈哈！
</p>
</div>
</div>
</div>
<div id="outline-container-org468eadb" class="outline-3">
<h3 id="org468eadb">紫薯布丁 <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-10-15 四&gt;</span></span>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="life">life</span></span></h3>
<div class="outline-text-3" id="text-org468eadb">
<p>
今天在emacs-china里看到有人回帖内容带有“紫薯布丁”，Google了一下才知道它的意思是，有些论坛回复有字数限制，必须达到一定数量的字数才能回帖。
所以就用“紫薯布丁”替代了，其又称为“字数补丁”真是有趣。
</p>
</div>
</div>
<div id="outline-container-orge924fd8" class="outline-3">
<h3 id="orge924fd8">上课时走神看到的陶渊明写的诗句 <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-10-15 四&gt;</span></span>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="life">life</span></span></h3>
<div class="outline-text-3" id="text-orge924fd8">
<p>
盛年不重来，一日难再晨。及时当勉励，岁月不待人。
</p>
</div>
</div>
<div id="outline-container-org478554f" class="outline-3">
<h3 id="org478554f">丢弃不稳定的xmodmap，转而使用hwdb设置键盘映射 <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-10-20 二&gt;</span></span>&#xa0;&#xa0;&#xa0;<span class="tag"><span class="linux">linux</span></span></h3>
<div class="outline-text-3" id="text-org478554f">
<blockquote>
<p>
xmodmap有个问题，就是只要有软件利用了xmodmap进行设置一些键位，那么你自定义的键位就会失效，例如在打开fcitx后你的xmodmap配置就会被覆盖，你就得重新执行那一条命令，让人十分的苦恼，为了解决这个方法，我看了下JimMoen写的一篇BILIBILI专栏: <a href="https://www.bilibili.com/read/cv5156572">Linux修改键位</a> ，写得非常好，但就是理论知识太多了，像我这种心急的人往往懒得看太多东西，想要快速上手，所以就有这篇文章了。
</p>
</blockquote>
</div>

<div id="outline-container-org1ba354b" class="outline-4">
<h4 id="org1ba354b">依赖包</h4>
<div class="outline-text-4" id="text-org1ba354b">
<ul class="org-ul">
<li>evtest
用于获取大量键盘相关信息</li>
</ul>
</div>
</div>
<div id="outline-container-org4c23353" class="outline-4">
<h4 id="org4c23353">具体操作</h4>
<div class="outline-text-4" id="text-org4c23353">
</div>
<div id="outline-container-orga83311c" class="outline-5">
<h5 id="orga83311c">获取必要信息</h5>
<div class="outline-text-5" id="text-orga83311c">
<p>
第一步，先查看你所需要更改的键盘的键位（利用hwdb支持根据不同设备设置不同的键位 ）。
</p>
<div class="org-src-container">
<pre class="src src-shell">su - <span style="color: #A7ABB2; font-style: italic;">#</span><span style="color: #A7ABB2; font-style: italic;">&#20999;&#25442;&#21040;root&#29992;&#25143;&#65292;&#19981;&#33021;&#29992;sudo</span>
evtest
</pre>
</div>

<p>
随后就会有一大堆信息，通常来说你只需要找到后缀有keybord的那个设备，例如我的就是第8号(/dev/input/event8):
</p>
<div class="org-src-container">
<pre class="src src-shell">No device specified, trying to scan all of /dev/input/event*
Available devices:
/dev/input/event0:      AT Translated Set 2 keyboard
/dev/input/event1:      Video Bus
/dev/input/event2:      Compx 2.4G Wireless Receiver
/dev/input/event3:      Compx 2.4G Wireless Receiver Keyboard
/dev/input/event4:      Compx 2.4G Wireless Receiver
/dev/input/event5:      Compx 2.4G Wireless Receiver Consumer Control
/dev/input/event6:      Compx 2.4G Wireless Receiver System Control
/dev/input/event7:      Compx 2.4G Wireless Receiver
/dev/input/event8:      ITE Tech. Inc. ITE Device<span style="color: #5A5E65;">(</span>8910<span style="color: #5A5E65;">)</span> Keyboard
/dev/input/event9:      ITE Tech. Inc. ITE Device<span style="color: #5A5E65;">(</span>8910<span style="color: #5A5E65;">)</span> Consumer Control
/dev/input/event10:     ITE Tech. Inc. ITE Device<span style="color: #5A5E65;">(</span>8910<span style="color: #5A5E65;">)</span> Wireless Radio Control
/dev/input/event11:     ITE Tech. Inc. ITE Device<span style="color: #5A5E65;">(</span>8910<span style="color: #5A5E65;">)</span> System Control
/dev/input/event12:     Lid Switch
/dev/input/event13:     Power Button
/dev/input/event14:     Power Button
/dev/input/event15:     Ideapad extra buttons
/dev/input/event16:     PC Speaker
/dev/input/event17:     Integrated Camera: Integrated C
/dev/input/event18:     MSFT0001:02 04F3:304B Mouse
/dev/input/event19:     MSFT0001:02 04F3:304B Touchpad
/dev/input/event20:     HDA Digital PCBeep
/dev/input/event21:     HDA Intel PCH Mic
/dev/input/event22:     HDA Intel PCH Headphone
/dev/input/event23:     HDA Intel PCH HDMI/DP,<span style="color: #007BD9;">pcm</span>=3
/dev/input/event24:     HDA Intel PCH HDMI/DP,<span style="color: #007BD9;">pcm</span>=7
/dev/input/event25:     HDA Intel PCH HDMI/DP,<span style="color: #007BD9;">pcm</span>=8
/dev/input/event26:     HDA Intel PCH HDMI/DP,<span style="color: #007BD9;">pcm</span>=9
/dev/input/event27:     HDA Intel PCH HDMI/DP,<span style="color: #007BD9;">pcm</span>=10
Select the device event number <span style="color: #5A5E65;">[</span>0-27<span style="color: #5A5E65;">]</span>: 
</pre>
</div>

<p>
选择了之后就会有关于所选设备的信息:
</p>
<div class="org-src-container">
<pre class="src src-shell">Input driver version is 1.0.1
Input device ID: bus 0x3 vendor 0x48d product 0xc937 version 0x110
Input device name: <span style="color: #008FAC;">"ITE Tech. Inc. ITE Device(8910) Keyboard"</span>
Supported events:
  Event type 0 <span style="color: #5A5E65;">(</span>EV_SYN<span style="color: #5A5E65;">)</span>
  Event type 1 <span style="color: #5A5E65;">(</span>EV_KEY<span style="color: #5A5E65;">)</span>
  Event code 1 <span style="color: #5A5E65;">(</span>KEY_ESC<span style="color: #5A5E65;">)</span>
  Event code 2 <span style="color: #5A5E65;">(</span>KEY_1<span style="color: #5A5E65;">)</span>
  ...
  Event type 4 <span style="color: #5A5E65;">(</span>EV_MSC<span style="color: #5A5E65;">)</span>
  Event code 4 <span style="color: #5A5E65;">(</span>MSC_SCAN<span style="color: #5A5E65;">)</span>
  Event type 17 <span style="color: #5A5E65;">(</span>EV_LED<span style="color: #5A5E65;">)</span>
  Event code 0 <span style="color: #5A5E65;">(</span>LED_NUML<span style="color: #5A5E65;">)</span> state 0
  Event code 1 <span style="color: #5A5E65;">(</span>LED_CAPSL<span style="color: #5A5E65;">)</span> state 0
  Event code 2 <span style="color: #5A5E65;">(</span>LED_SCROLLL<span style="color: #5A5E65;">)</span> state 0
  Event code 3 <span style="color: #5A5E65;">(</span>LED_COMPOSE<span style="color: #5A5E65;">)</span> state 0
  Event code 4 <span style="color: #5A5E65;">(</span>LED_KANA<span style="color: #5A5E65;">)</span> state 0
  Key repeat handling:
  Repeat type 20 <span style="color: #5A5E65;">(</span>EV_REP<span style="color: #5A5E65;">)</span>
  Repeat code 0 <span style="color: #5A5E65;">(</span>REP_DELAY<span style="color: #5A5E65;">)</span>
  Value    250
  Repeat code 1 <span style="color: #5A5E65;">(</span>REP_PERIOD<span style="color: #5A5E65;">)</span>
  Value     33
  Properties:
</pre>
</div>

<p>
我们只需要关注Input device ID这一项，先记住它。
下面你随便按一个按键就会被按下按键的相关信息。
</p>

<p>
比如如下信息中就是我按下LEFT ALT获得到的信息:
</p>
<div class="org-src-container">
<pre class="src src-shell">Event: time 1603130102.353570, -------------- SYN_REPORT ------------
Event: time 1603130102.353570, type 4 <span style="color: #5A5E65;">(</span>EV_MSC<span style="color: #5A5E65;">)</span>, code 4 <span style="color: #5A5E65;">(</span>MSC_SCAN<span style="color: #5A5E65;">)</span>, value 700e3
Event: time 1603130102.353570, type 1 <span style="color: #5A5E65;">(</span>EV_KEY<span style="color: #5A5E65;">)</span>, code 56 <span style="color: #5A5E65;">(</span>KEY_LEFTALT<span style="color: #5A5E65;">)</span>, value 1
Event: time 1603130102.353570, -------------- SYN_REPORT ------------
Event: time 1603130102.441558, type 4 <span style="color: #5A5E65;">(</span>EV_MSC<span style="color: #5A5E65;">)</span>, code 4 <span style="color: #5A5E65;">(</span>MSC_SCAN<span style="color: #5A5E65;">)</span>, value 700e3
Event: time 1603130102.441558, type 1 <span style="color: #5A5E65;">(</span>EV_KEY<span style="color: #5A5E65;">)</span>, code 56 <span style="color: #5A5E65;">(</span>KEY_LEFTALT<span style="color: #5A5E65;">)</span>, value 0
</pre>
</div>
<p>
每个SYN<sub>REPORT代表一个操作</sub>，例如第一个SYN<sub>REPORT代表按下LEFT</sub> ALT，因为其type1项的value值是1。我们只需要记住type4项中的value值即可。
</p>
</div>
</div>

<div id="outline-container-org477c1b2" class="outline-5">
<h5 id="org477c1b2">编写自定义按键映射</h5>
<div class="outline-text-5" id="text-org477c1b2">
<p>
创建文件 <b><b>/etc/udev/hwdb.d/99-personal-kbd.hwdb</b></b> ，这里的99代表优先级，由于是自定义的所以我们将其设置为最高。
</p>

<p>
文件内容如下:
</p>

<div class="org-src-container">
<pre class="src src-text">evdev:input:b0003v*
 KEYBOARD_KEY_700e2=leftmeta    # bind LEFT ALT to SUPER
</pre>
</div>

<p>
<b><b>注意KEYBOARD<sub>KEY开头的空格缩进</sub></b></b>
</p>

<p>
evdev表示要修改映射的设备，后面跟着的表示匹配设备的相关信息，这里也就是我们前面提到的Input Device ID(bus 0x3 vendor 0x48d product 0xc937 version 0x110)。
由于我不需要多么精准的匹配，因为我只有一个设备，所以我只是精准匹配了bus信息以及贪婪匹配了vendor，其他的我都忽lue(mmp这个输入法很沙比)了。
</p>

<p>
<b><b>还有一项要注意的是获取必要信息时的bus值是0x3为什么我写的是0003?</b></b> 答案是，不够4位用0补齐。
</p>
</div>
</div>

<div id="outline-container-orgba0803b" class="outline-5">
<h5 id="orgba0803b">加载配置</h5>
<div class="outline-text-5" id="text-orgba0803b">
<p>
执行如下命令即可:
</p>
<div class="org-src-container">
<pre class="src src-shell">udevadm hwdb --update <span style="color: #A7ABB2; font-style: italic;">#</span><span style="color: #A7ABB2; font-style: italic;">&#26356;&#26032;&#38190;&#30424;&#26144;&#23556;&#25968;&#25454;&#24211;</span>
udevadm trigger <span style="color: #A7ABB2; font-style: italic;"># </span><span style="color: #A7ABB2; font-style: italic;">&#24212;&#29992;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf1959dd" class="outline-5">
<h5 id="orgf1959dd">最后</h5>
<div class="outline-text-5" id="text-orgf1959dd">
<p>
本文参考JimMoen的专栏文章，详情请去看这位帅哥的文章。
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2020-07-14 二 00:00</p>
<p class="author">Author: Evan Meek</p>
<p class="date">Created: 2020-11-10 二 15:31</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
